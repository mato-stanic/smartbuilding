<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head lang="en">
    <meta charset="UTF-8"/>
    <title>Smart building</title>
</head>
<body>





<div class="panel panel-default consumption-dest-group" th:fragment="content(parentId, dg, allDestResults, level, autoExpandLevelLimit)"
     th:with="cr=${dg.getConsumptionResult(allDestResults)}">

    <div class="panel-heading">

        <table class="table">
            <tr>
                <td th:text="${dg.name}"></td>
                <td width="100" th:text="|${dg.getConsumptionUnitsCount()} ${dg.serviceType.unitName}|"></td>
                <td width="100" th:text="${cr.getTotalCost() + ' €'}"> cost</td>
                <td width="100" align="right">
                    <a th:if="${!dg.expanded}" role="button" data-toggle="collapse" title="Prikaži detaljniju raspodjelu" th:href="${'#' + parentId + '-children'}" style="font-size: 16px !important;" aria-expanded="false" onclick="toggleTreeNodeExpand(this);">
                        <i class="glyphicon glyphicon-collapse-down"></i>
                    </a>


                </td>
            </tr>
        </table>

    </div>


    <div class="panel-body" >

        <div class="result-overview" th:if="${dg.friendNo}">
            <span th:if="${dg.note}" th:text="${dg.note}">Napomena ako je ima</span>
        </div>

        <div class="result-overview">
            <span th:if="${cr.freeUnits > 0}"> Besplatno <span th:text="|${cr.freeUnits} ${cr.serviceType.unitName}|"></span> <br/> </span>
            <span th:if="${cr.unitsCoveredByMonthlyFee > 0}">Pokriveno iznosom uključenim u pretplatu <span th:text="|${cr.getUnitsCoveredByMonthlyFee()} ${cr.serviceType.unitName}|"></span>  <br/> </span>

            <span th:each="opMin : ${cr.unitsCoveredByOptions.entrySet()}">
                <span th:text="|${opMin.value} ${cr.serviceType.unitName} pokriveno opcijom |"></span> "<span th:text="${opMin.key.name}"></span>"<br/>
            </span>

            <span th:if="${cr.totalChargedUnits > 0}">
                Naplaćeno
                <span th:if="${cr.totalChargedUnits > 0}"><span th:text="|${cr.totalChargedUnits} ${cr.serviceType.billingUnit} , ${cr.totalCost}|"></span> € </span><br/>
            </span>

        </div>

        <div class="dest-group-children" th:classappend="${!dg.expanded} ? 'collapse' : ''" th:id="${parentId + '-children'}" >

            <div th:each="cg : ${dg.getDestinationGroups()}">
                <div th:replace="calculator/dest-group-result :: content(${parentId + '-' + cgStat.index}, ${cg}, ${allDestResults}, ${level +1}, ${autoExpandLevelLimit})"></div>
            </div>

            <div th:each=" cd : ${dg.getDestinations().keySet()}" th:with="cdr=${allDestResults.get(cd)}">
                <div th:replace="calculator/dest-result :: content(${cd}, ${cdr}, ${level +1})"></div>
            </div>
        </div>

    </div>


</div>


</body>
</html>